# Simple NetFlow configuration with improved defaults
# This configuration reduces log noise and provides better template handling

sources:
  netflow:
    type: netflow
    address: "0.0.0.0:2055"
    protocols: ["ipfix"]  # Only enable IPFIX to reduce complexity
    # Template buffering is enabled by default to handle missing templates gracefully
    buffer_missing_templates: true
    max_buffered_records: 100
    # Reasonable defaults for most environments
    max_templates: 1000
    template_timeout: 3600  # 1 hour
    max_length: 65535
    max_field_length: 1024

transforms:
  # Optional: Add metadata to identify the source
  add_source_metadata:
    type: remap
    inputs: ["netflow"]
    source: |
      .source = "netflow"
      .timestamp = now()

sinks:
  console:
    type: console
    inputs: ["add_source_metadata"]
    encoding:
      codec: json
