# Journald Sink Example
# ------------------------------------------------------------------------------
# A simple example showing how to send logs to systemd journal.
# This demonstrates forwarding logs from a dummy source, parsing syslog messages,
# and mapping syslog severity levels to journal priority levels.

sources:
  dummy_logs:
    type: "demo_logs"
    format: "syslog"
    interval: 1

transforms:
  parse_syslog:
    type: "remap"
    inputs: ["dummy_logs"]
    source: |
      . = parse_syslog!(string!(.message))

  map_severity_to_priority:
    # Map the syslog severity to journal priority levels
    type: "remap"
    inputs: ["parse_syslog"]
    source: |
      .priority = if .severity == "emerg" {
        0
      } else if .severity == "alert" {
        1
      } else if .severity == "crit" {
        2
      } else if .severity == "err" {
        3
      } else if .severity == "warning" {
        4
      } else if .severity == "notice" {
        5
      } else if .severity == "info" {
        6
      } else if .severity == "debug" {
        7
      } else {
        6
      }

sinks:
  local_journal:
    inputs: ["map_severity_to_priority"]
    type: "journald"
