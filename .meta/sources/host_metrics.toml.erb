[sources.host_metrics]
title = "Host Metrics"
noun = "Host Metrics"
beta = true
common = false
delivery_guarantee = "at_least_once"
features = [
  "Gather host-based metrics.",
]
function_category = "collect"
output_types = ["metric"]
requirements = {}
strategies = ["daemon"]
through_description = "local system data sources"

<%= render("_partials/fields/_component_options.toml", type: "source", name: "host_metrics") %>

[sources.host_metrics.options.collectors]
type = "[string]"
common = false
required = false
description = "The list of host metric collector services to use. Defaults to all collectors."

[sources.host_metrics.options.collectors.enum]
cpu = "Metrics related to CPU utilization."
disk = "Metrics related to disk I/O utilization."
filesystem = "Metrics related to filesystem space utilization."
load = "Load average metrics (UNIX only)."
memory = "Metrics related to memory utilization."
network = "Metrics related to network utilization."

[sources.host_metrics.options.namespace]
type = "string"
common = false
required = false
default = "host"
description = "The namespace prefix that will be added to all metric names."

[sources.host_metrics.options.scrape_interval_secs]
type = "integer"
common = false
required = false
default = 15
description = "The interval between metric gathering, in seconds."

[sources.host_metrics.options.disk]
type = "table"
category = "Filesystem"
description = "Options for the \"disk\" metrics collector."

<%= render("_partials/fields/_includes_excludes.toml",
  namespace: "sources.host_metrics.options.disk.options.devices",
  term: "device name",
  metrics: "I/O",
  examples: [["sda"], ["dm-*"]]
) %>

[sources.host_metrics.options.filesystem]
type = "table"
category = "Filesystem"
description = "Options for the \"filesystem\" metrics collector."

<%= render("_partials/fields/_includes_excludes.toml",
  namespace: "sources.host_metrics.options.filesystem.options.devices",
  term: "device name",
  metrics: "usage",
  examples: [["sda"], ["dm-*"]]
) %>

<%= render("_partials/fields/_includes_excludes.toml",
  namespace: "sources.host_metrics.options.filesystem.options.filesystems",
  term: "filesystem name",
  metrics: "usage",
  examples: [["ntfs"], ["ext*"]]
) %>

<%= render("_partials/fields/_includes_excludes.toml",
  namespace: "sources.host_metrics.options.filesystem.options.mountpoints",
  term: "mountpoint path",
  metrics: "usage",
  examples: [["/home"], ["/raid*"]]
) %>

[sources.host_metrics.options.network]
type = "table"
category = "Network"
description = "Options for the \"network\" metrics collector."

<%= render("_partials/fields/_includes_excludes.toml",
  namespace: "sources.host_metrics.options.network.options.devices",
  term: "mountpoint path",
  metrics: "utilization",
  examples: [["eth0"], ["enp?s*"]]
) %>

[[sources.apache_metrics.examples]]
label = "Generic"
body = """\
The host metrics source generates the following metrics on all operating systems:

```text title="Example metrics"
2020-10-02T23:15:13.451763855Z host_cpu_seconds_total{collector="cpu",cpu="0",host="myhost",mode="idle"} = 69470.45
2020-10-02T23:15:13.451763855Z host_cpu_seconds_total{collector="cpu",cpu="0",host="myhost",mode="system"} = 326.53
2020-10-02T23:15:13.451763855Z host_cpu_seconds_total{collector="cpu",cpu="0",host="myhost",mode="user"} = 1495.86
2020-10-02T23:15:13.451900716Z host_cpu_seconds_total{collector="cpu",cpu="1",host="myhost",mode="idle"} = 69433.11
2020-10-02T23:15:13.451900716Z host_cpu_seconds_total{collector="cpu",cpu="1",host="myhost",mode="system"} = 318.86
2020-10-02T23:15:13.451900716Z host_cpu_seconds_total{collector="cpu",cpu="1",host="myhost",mode="user"} = 1580.48
2020-10-02T23:15:13.454559229Z host_disk_read_bytes_total{collector="disk",device="sda",host="myhost"} = 6769332736
2020-10-02T23:15:13.454559229Z host_disk_reads_completed_total{collector="disk",device="sda",host="myhost"} = 178260
2020-10-02T23:15:13.454559229Z host_disk_written_bytes_total{collector="disk",device="sda",host="myhost"} = 68095904256
2020-10-02T23:15:13.454559229Z host_disk_writes_completed_total{collector="disk",device="sda",host="myhost"} = 589053
2020-10-02T23:15:13.454644259Z host_disk_read_bytes_total{collector="disk",device="sda1",host="myhost"} = 4853248
2020-10-02T23:15:13.454644259Z host_disk_reads_completed_total{collector="disk",device="sda1",host="myhost"} = 123
2020-10-02T23:15:13.454644259Z host_disk_written_bytes_total{collector="disk",device="sda1",host="myhost"} = 512
2020-10-02T23:15:13.454644259Z host_disk_writes_completed_total{collector="disk",device="sda1",host="myhost"} = 1
2020-10-02T23:15:13.458819434Z host_filesystem_free_bytes{collector="filesystem",device="/dev/sda1",filesystem="btrfs",host="myhost",mountpoint="/"} = 6037008384
2020-10-02T23:15:13.458819434Z host_filesystem_total_bytes{collector="filesystem",device="/dev/sda1",filesystem="btrfs",host="myhost",mountpoint="/"} = 21474836480
2020-10-02T23:15:13.458819434Z host_filesystem_used_bytes{collector="filesystem",device="/dev/sda1",filesystem="btrfs",host="myhost",mountpoint="/"} = 13720162304
2020-10-02T23:15:13.463284771Z host_memory_total_bytes{collector="memory",host="myhost"} = 32811676000
2020-10-02T23:15:13.463284771Z host_memory_free_bytes{collector="memory",host="myhost"} = 2265256000
2020-10-02T23:15:13.463284771Z host_memory_available_bytes{collector="memory",host="myhost"} = 23939776000
2020-10-02T23:15:13.463746084Z host_memory_swap_free_bytes{collector="memory",host="myhost"} = 2097148000
2020-10-02T23:15:13.463746084Z host_memory_swap_total_bytes{collector="memory",host="myhost"} = 2097148000
2020-10-02T23:15:13.463746084Z host_memory_swap_used_bytes{collector="memory",host="myhost"} = 0
2020-10-02T23:15:13.464392430Z host_network_receive_bytes_total{collector="network",device="enp5s0",host="myhost"} = 3420962102
2020-10-02T23:15:13.464392430Z host_network_receive_errs_total{collector="network",device="enp5s0",host="myhost"} = 0
2020-10-02T23:15:13.464392430Z host_network_receive_packets_drop_total{collector="network",device="enp5s0",host="myhost"} = 0
2020-10-02T23:15:13.464392430Z host_network_receive_packets_total{collector="network",device="enp5s0",host="myhost"} = 0
2020-10-02T23:15:13.464392430Z host_network_transmit_bytes_total{collector="network",device="enp5s0",host="myhost"} = 990111734
2020-10-02T23:15:13.464392430Z host_network_transmit_errs_total{collector="network",device="enp5s0",host="myhost"} = 0
```\
"""

[[sources.apache_metrics.examples]]
label = "Linux"
body = """\
On Linux-based hosts, the host metrics source generates the following additional metrics:

```text title="Example metrics"
2020-10-02T23:15:13.451763855Z host_cpu_seconds_total{collector="cpu",cpu="0",host="myhost",mode="nice"} = 2.29
2020-10-02T23:15:13.451900716Z host_cpu_seconds_total{collector="cpu",cpu="1",host="myhost",mode="nice"} = 1.6
2020-10-02T23:15:13.463095509Z host_load1{collector="load",host="myhost"} = 0.8199999928474426
2020-10-02T23:15:13.463095509Z host_load5{collector="load",host="myhost"} = 0.6299999952316284
2020-10-02T23:15:13.463095509Z host_load15{collector="load",host="myhost"} = 0.5699999928474426
2020-10-02T23:15:13.463284771Z host_memory_active_bytes{collector="memory",host="myhost"} = 20786712000
2020-10-02T23:15:13.463284771Z host_memory_buffers_bytes{collector="memory",host="myhost"} = 7732000
2020-10-02T23:15:13.463284771Z host_memory_cached_bytes{collector="memory",host="myhost"} = 21071548000
2020-10-02T23:15:13.463284771Z host_memory_shared_bytes{collector="memory",host="myhost"} = 775952000
2020-10-02T23:15:13.463284771Z host_memory_used_bytes{collector="memory",host="myhost"} = 9467140000
2020-10-02T23:15:13.463746084Z host_memory_swapped_in_bytes_total{collector="memory",host="myhost"} = 0
2020-10-02T23:15:13.463746084Z host_memory_swapped_out_bytes_total{collector="memory",host="myhost"} = 0
2020-10-02T23:15:13.464392430Z host_network_transmit_packets_total{collector="network",device="enp5s0",host="myhost"} = 2347835
```\
"""

[[sources.apache_metrics.examples]]
label = "Windows"
body = """\
On Windows-based hosts, the host metrics source generates the following additional metrics:

```text title="Example metrics"
2020-10-02T23:15:13.464392430Z host_network_transmit_packets_total{collector="network",device="enp5s0",host="myhost"} = 2347835
```\
"""

[[sources.apache_metrics.examples]]
label = "MacOS"
body = """\
On MacOS-based hosts, the host metrics source generates the following additional metrics:

```text title="Example metrics"
2020-10-02T23:15:13.463095509Z host_load1{collector="load",host="myhost"} = 0.8199999928474426
2020-10-02T23:15:13.463095509Z host_load5{collector="load",host="myhost"} = 0.6299999952316284
2020-10-02T23:15:13.463095509Z host_load15{collector="load",host="myhost"} = 0.5699999928474426
2020-10-02T23:15:13.463284771Z host_memory_active_bytes{collector="memory",host="myhost"} = 20786712000
2020-10-02T23:15:13.463284771Z host_memory_inactive_bytes{collector="memory",host="myhost"} = 16748000
2020-10-02T23:15:13.463746084Z host_memory_swapped_in_bytes_total{collector="memory",host="myhost"} = 0
2020-10-02T23:15:13.463746084Z host_memory_swapped_out_bytes_total{collector="memory",host="myhost"} = 0
2020-10-02T23:15:13.463284771Z host_memory_wired_bytes{collector="memory",host="myhost"} = 34784828000
```\
"""
